---
title: "R Notebook"
output:
  html_document:
    df_print: paged
---

```{r echo=FALSE, message=FALSE, warning=FALSE}
# Importing libraries
library(tidyverse)
library(here)
library(lubridate)
library(ggbeeswarm)
library(ggplot2)
library(lubridate)
library(gridExtra)

theme_set(theme_bw())
```

## __Overview__
Esses dados tem como fonte o INMET e representam a temperatura e o volume de chuva ao longo das semanas das cidades de Campina Grande e Jo„o Pessoa entre os anos de 2008 atÈ 2019. Logo abaixo, vemos uma amostra desses dados. 


```{r}

climas = read_csv(here::here("data/clima_cg_jp-semanal.csv"), 
                  col_types = "cTdddddd")
head(climas)

```




Com esses dados em m√£os vamos tentar responder as seguintes perguntas:\
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1. Onde √© mais quente?\
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2. Quais os meses mais quentes e mais frios?\
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3. Quanto chove por semana em JP e CG?\
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4. A distribui√ß√£o √© diferente em meses espec√≠ficos? \
 
## __Quais os meses mais quentes e mais frios?__
Podemos agrupar as temperaturas por meses e analisar o resultado para responder esta pergunta. 

```{r}

    climas = climas %>%  mutate(dia=lubridate::day(semana)) %>% mutate(estacao = if_else(mes>=4 & mes <=6,  "Outono",
                                         if_else(mes>=7 & mes <=9,  "Inverno",
                                                 if_else(mes>=9 & mes <=11,  "Primavera",
                                                         if_else(mes==12 | mes <=3,  "Verao", "NA")
                                                         )
                                                 )
                                         )
                       )

    density_by_seasons = climas %>%
                            ggplot(aes(x = tmedia)) + 
                                geom_density(alpha = .4, fill = "salmon") + 
                                    facet_wrap(~ estacao)
            
    
    density_by_months = climas %>%
                            ggplot(aes(x = tmedia)) + 
                                geom_density(alpha = .4, fill = "salmon") + 
                                    facet_wrap(~ mes)
    boxplot_by_seasons = climas %>% 
                            ggplot(aes(x = estacao, y = tmedia)) + 
                                geom_boxplot(coef = 1000, width = .2) 

    grid.arrange(density_by_months, ncol = 1)
    grid.arrange(density_by_seasons, ncol = 1)
    grid.arrange(boxplot_by_seasons, ncol = 1)
```


Analisando as distribui√ß√µes de temperatura ao longo dos meses, notamos uma certa tendencia a ter temperaturas maiores no fim e come√ßo do ano, ao passo que nos meses que se encontram no meio do ano, a temperatura tende a ser menor. Para que a an√°lise ficasse mais clara, um agrupamento da temperatura por esta√ß√µes do ano foi feito e vemos que os meses que correspondem ao Ver√£o e Primavera, ou seja Setembro at√© Mar√ßo, tem uma mediana de temperatura maior. De forma contr√°ria, os meses que estendem de Abril at√© Julho apresentam uma menor mediana de temperatura.







## __A distribuiÁ„o È diferente em meses especÌficos?__ PERGUNTA PRA RESPONDER !!!!
<p>Vamos agora agrupar o volume de precipitaÁ„o de chuva por meses e analisar o resultado.</p> 

```{r}
rain_density_by_months = climas %>%
                            ggplot(aes(x = chuva)) + 
                                geom_density(alpha = .4, fill = "salmon") + 
                                    facet_wrap(~ mes)
grid.arrange(rain_density_by_months, ncol=1)
```

Analisando as distribuiÁıes acima, vemos que o volume de chuva difere quanto ao mÍs. Por exemplo, os meses de Novembro e Dezembro apresentam um volume de chuva bem mais baixo do que os outros meses, visto que a os dados se encontram concentrados no zero. Lembrando que tais meses est„o relacionados com o fim da primavera e inÌcio do ver„o, relaÁ„o esta que explica o baixo volume de chuva nessa Època.

Agora, para expandir a an·lise da distribuiÁ„o de chuvas vamos analisar a densidade de probabilidade em Campina Grande e Jo„o Pessoa separadamente. 

```{r}

rain_cidades_density_by_months = climas %>%
                            ggplot(aes(x = chuva, y=..scaled.., fill = cidade)) + 
                                  geom_vline(aes(xintercept=tmedia,  colour=cidade),
                                               linetype="dashed", size=1) +
                                geom_density(alpha = .4, position = "identity") +
                                                  facet_wrap(~ mes)

grid.arrange(rain_cidades_density_by_months)
```

Analisando as distribuiÁıes de cada cidade È possÌvel perceber que Jo„o Pessoa tem uma variaÁ„o maior na quantidade de chuvas que Campina Grande, apesar da mÈdia da quantidade de chuvas se parecida na maioria dos meses.